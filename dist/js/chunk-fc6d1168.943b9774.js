(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc6d1168"],{bd68:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("div",{staticClass:"table"},[r("div",{staticClass:"container"},[r("div",{staticClass:"handle-box"},[r("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[r("el-form",{attrs:{inline:!0,model:e.queryinfo}},[r("el-form-item",[e._v(" 姓名： "),r("el-input",{staticStyle:{width:"200px",heght:"30px"},attrs:{placeholder:"请输入姓名",size:"mini",clearable:""},model:{value:e.queryinfo.name,callback:function(t){e.$set(e.queryinfo,"name",t)},expression:"queryinfo.name"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.getUserList()}}},[e._v("搜索")])],1)],1)],1)],1),r("el-button",{attrs:{type:"success",icon:"el-icon-circle-plus-outline",size:"mini",round:""},on:{click:e.handleAdd}},[e._v("新增")]),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",round:""},on:{click:e.handleDeleteList}},[e._v("删除")]),[r("el-table",{ref:"multipleTable",staticClass:"el-tb-edit mgt20",attrs:{data:e.tableData,size:"mini","highlight-current-row":"",border:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"40"}}),r("el-table-column",{attrs:{type:"index",label:"序号"}}),r("el-table-column",{attrs:{prop:"name",label:"姓名"}}),r("el-table-column",{attrs:{prop:"account",label:"登录名"}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色"}}),r("el-table-column",{attrs:{prop:"phone",label:"手机"}}),r("el-table-column",{attrs:{prop:"email",label:"邮件"}}),r("el-table-column",{attrs:{prop:"sex",label:"性别",formatter:e.formatSex,sortable:""}}),r("el-table-column",{attrs:{label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(r){return e.userStatus(t.$index,t.row)}},model:{value:t.row.status,callback:function(r){e.$set(t.row,"status",r)},expression:"scope.row.status"}})]}}])}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"warning",plain:"",size:"small"},on:{click:function(r){return e.handleRole(t.$index,t.row)}}},[e._v("角色")]),r("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:function(r){return e.resetPassword(t.$index,t.row)}}},[e._v("重置密码")])]}}])})],1),r("br"),r("el-pagination",{attrs:{"current-page":e.queryinfo.pagenum,"page-sizes":[10,20,50,100],"page-size":e.queryinfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalpage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]],2)]),r("el-dialog",{attrs:{title:"新增",width:"400px",visible:e.addFormVisible,"before-close":e.addCancel},on:{"update:visible":function(t){e.addFormVisible=t}}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入姓名"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),r("br"),r("el-form-item",{attrs:{label:"账号",prop:"account"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入账号"},model:{value:e.addForm.account,callback:function(t){e.$set(e.addForm,"account",t)},expression:"addForm.account"}})],1),r("br"),r("el-form-item",{attrs:{label:"登录密码",prop:"oldPassword"}},[r("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入登陆密码"},model:{value:e.addForm.oldPassword,callback:function(t){e.$set(e.addForm,"oldPassword",t)},expression:"addForm.oldPassword"}})],1),r("br"),r("el-form-item",{attrs:{label:"重复密码",prop:"passwordAgain"}},[r("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入重复密码"},model:{value:e.addForm.passwordAgain,callback:function(t){e.$set(e.addForm,"passwordAgain",t)},expression:"addForm.passwordAgain"}})],1),r("br"),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.addForm.sex,callback:function(t){e.$set(e.addForm,"sex",t)},expression:"addForm.sex"}},[r("el-radio",{attrs:{label:"1"}},[e._v("男")]),r("el-radio",{attrs:{label:"2"}},[e._v("女")])],1)],1),r("br"),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{attrs:{type:"‘number’","auto-complete":"off",placeholder:"请输入手机"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1),r("br"),r("el-form-item",{attrs:{label:"邮件",prop:"email"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入邮箱"},model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),r("br")],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.addCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("提交")])],1)],1),r("el-dialog",{attrs:{title:"角色",width:"400px",visible:e.editRoleFormVisible},on:{"update:visible":function(t){e.editRoleFormVisible=t}}},[r("el-form",{ref:"editRoleForm",attrs:{model:e.editRoleForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.editRoleForm.roleId,callback:function(t){e.$set(e.editRoleForm,"roleId",t)},expression:"editRoleForm.roleId"}},e._l(e.editRoleForm.rolesList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editRoleFormVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.eddRoleSubmit}},[e._v("提交")])],1)],1),r("el-dialog",{attrs:{title:"修改",width:"400px",visible:e.editFormVisible,"before-close":e.editCancel},on:{"update:visible":function(t){e.editFormVisible=t}}},[r("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入姓名"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),r("br"),r("el-form-item",{attrs:{label:"账号",prop:"account"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入账号"},model:{value:e.editForm.account,callback:function(t){e.$set(e.editForm,"account",t)},expression:"editForm.account"}})],1),r("br"),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}},[r("el-radio",{attrs:{label:"1"}},[e._v("男")]),r("el-radio",{attrs:{label:"2"}},[e._v("女")])],1)],1),r("br"),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{attrs:{type:"‘number’","auto-complete":"off",placeholder:"请输入手机"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),r("br"),r("el-form-item",{attrs:{label:"邮件",prop:"email"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入邮箱"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),r("br")],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.editCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editSubmit}},[e._v("提交")])],1)],1)],1)},s=[],o=(r("99af"),r("d81d"),r("96cf"),r("1da1")),n=r("9e7a"),i={data:function(){var e=this,t=function(t,r,a){""===r?a(new Error("请再次输入密码")):r!==e.addForm.oldPassword?a(new Error("两次输入密码不一致!")):a()};return{queryinfo:{name:"",pagenum:1,pagesize:10},totalpage:0,tableData:[],selectList:[],deleteListId:[],addFormVisible:!1,addForm:{name:"",account:"",oldPassword:"",password:"",passwordAgain:"",phone:"",email:"",sex:"1"},addFormRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:1,max:5,message:"姓名在1-5个字符之间",trigger:"blur"}],account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:1,max:10,message:"账号在1-10个字符之间",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入密码",trigger:"blur"},{min:1,max:15,message:"密码在1-15个字符之间",trigger:"blur"}],passwordAgain:[{validator:t,trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],phone:[{pattern:/^((0\d{2,3}-\d{7,8})|(1[3584]\d{9}))$/,message:"请输入正确的电话号码",trigger:"blur"}]},editRoleFormVisible:!1,editRoleForm:{roleId:"",userId:"",rolesList:[]},editFormVisible:!1,editForm:{},editFormRules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:1,max:5,message:"姓名在1-5个字符之间",trigger:"blur"}],account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:1,max:10,message:"账号在1-10个字符之间",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],phone:[{pattern:/^((0\d{2,3}-\d{7,8})|(1[3584]\d{9}))$/,message:"请输入正确的电话号码",trigger:"blur"}]}}},computed:{},mounted:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.getters.getRole("users","get")){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.get("users",{params:e.queryinfo});case 4:if(r=t.sent,200===r.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error(r.meta.msg));case 7:e.tableData=r.data.datas,e.totalpage=r.data.totalpage,e.pagenum=r.data.pagenum;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryinfo.pagesize=e,this.queryinfo.pagenum=1,this.getUserList()},handleCurrentChange:function(e){this.queryinfo.pagenum=e,this.getUserList()},formatSex:function(e,t){return 1==e.sex?"男":2==e.sex?"女":"未知"},userStatus:function(e,t){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var s,o,n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r.$store.getters.getRole("users/{id}/state/{state}","put")){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,r.$http.put("users/".concat(t.id,"/state/").concat(t.status));case 4:s=a.sent,console.log(s),o=s.meta,n=o.status,i=o.msg,200===n?r.$message.success(i):(r.$message.error(i),r.tableData[e].state=!r.tableData[e].state);case 8:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.deleteListId=e.map((function(e){return e.id}))},handleAdd:function(){this.$store.getters.getRole("users","post")||(this.addFormVisible=!0)},addCancel:function(){this.addFormVisible=!1,this.$refs.addForm.resetFields()},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",!1);case 2:return e.addForm.password=Object(n["a"])(e.addForm.oldPassword),t.next=5,e.$http.post("users",e.addForm);case 5:if(a=t.sent,201===a.meta.status){t.next=9;break}return e.$message.error(a.meta.msg),t.abrupt("return");case 9:e.$message.success(a.meta.msg),e.$refs.addForm.resetFields(),e.addFormVisible=!1,e.getUserList();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleDeleteList:function(){var e=this;this.$store.getters.getRole("users","delete")||(0!=this.deleteListId.length?this.$confirm("确认删除吗？","提示",{}).then(Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.delete("users",{data:{ids:e.deleteListId}});case 2:if(r=t.sent,console.log(r),204===r.meta.status){t.next=7;break}return e.$message.error(r.meta.msg),t.abrupt("return");case 7:e.$message.success(r.meta.msg),e.getUserList();case 9:case"end":return t.stop()}}),t)})))).catch((function(){})):this.$message.error("请选择要删除的数据"))},resetPassword:function(e,t){var r=this;this.$store.getters.getRole("users/{id}/password","put")||this.$confirm("是否密码重置为123456？","提示",{}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$http.put("users/".concat(t.id,"/password"),{password:Object(n["a"])("123456")});case 2:if(a=e.sent,console.log(a),200===a.meta.status){e.next=7;break}return r.$message.error(a.meta.msg),e.abrupt("return");case 7:r.$message.success(a.meta.msg);case 8:case"end":return e.stop()}}),e)})))).catch((function(){}))},handleRole:function(e,t){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.$store.getters.getRole("users/{id}/role/{roleId}","put")){e.next=2;break}return e.abrupt("return");case 2:return console.log("谁",t),r.editRoleFormVisible=!0,e.next=6,r.$http.get("roles/list");case 6:if(a=e.sent,200===a.meta.status){e.next=10;break}return r.$message.error(a.meta.msg),e.abrupt("return");case 10:r.editRoleForm.roleId=t.roleId,r.editRoleForm.userId=t.id,r.editRoleForm.rolesList=a.data.datas;case 13:case"end":return e.stop()}}),e)})))()},editCancel:function(){this.editFormVisible=!1,this.$refs.editForm.resetFields()},eddRoleSubmit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("users/".concat(e.editRoleForm.userId,"/role/").concat(e.editRoleForm.roleId));case 2:if(r=t.sent,console.log("heh",r),200===r.meta.status){t.next=7;break}return e.$message.error(r.meta.msg),t.abrupt("return");case 7:e.$message.success(r.meta.msg),e.editRoleFormVisible=!1,e.getUserList();case 10:case"end":return t.stop()}}),t)})))()},handleEdit:function(e,t){this.$store.getters.getRole("users","put")||(this.editForm=JSON.parse(JSON.stringify(t)),this.editFormVisible=!0)},editSubmit:function(){var e=this;this.$refs.editForm.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,e.$http.put("users",e.editForm);case 4:if(a=t.sent,200===a.meta.status){t.next=8;break}return e.$message.error(a.meta.msg),t.abrupt("return");case 8:e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.getUserList();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},l=i,u=r("2877"),d=Object(u["a"])(l,a,s,!1,null,null,null);t["default"]=d.exports},d81d:function(e,t,r){"use strict";var a=r("23e7"),s=r("b727").map,o=r("1dde"),n=r("ae40"),i=o("map"),l=n("map");a({target:"Array",proto:!0,forced:!i||!l},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-fc6d1168.943b9774.js.map