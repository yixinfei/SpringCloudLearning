(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ba30c"],{"35c7":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("div",{staticClass:"table"},[r("div",{staticClass:"container"},[r("div",{staticClass:"handle-box"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-tree",{attrs:{data:e.treeMenusListAll,"node-key":"id","expand-on-click-node":!1,"default-expand-all":"",props:e.defaultProps,"highlight-current":""},on:{"node-click":e.handleNodeClick}})],1),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"handle-box"},[r("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[r("el-form",{attrs:{inline:!0,model:e.queryinfo}},[r("el-form-item",[e._v(" 菜单名称： "),r("el-input",{staticStyle:{width:"200px",heght:"30px"},attrs:{placeholder:"请输入菜单名称",size:"mini",clearable:""},model:{value:e.queryinfo.title,callback:function(t){e.$set(e.queryinfo,"title",t)},expression:"queryinfo.title"}})],1),r("el-form-item",[e._v(" 菜单层级： "),r("el-input",{staticStyle:{width:"200px",heght:"30px"},attrs:{placeholder:"请输入菜单层级",size:"mini",clearable:""},model:{value:e.queryinfo.levels,callback:function(t){e.$set(e.queryinfo,"levels",t)},expression:"queryinfo.levels"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.getMenuList()}}},[e._v("搜索")])],1)],1)],1)],1),r("el-button",{attrs:{type:"success",icon:"el-icon-circle-plus-outline",size:"mini",round:""},on:{click:e.handleAdd}},[e._v("新增")]),[r("el-table",{ref:"multipleTable",staticClass:"el-tb-edit mgt20",attrs:{data:e.tableData,size:"mini","highlight-current-row":"",border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",sortable:""}}),r("el-table-column",{attrs:{prop:"title",label:"菜单名称"}}),r("el-table-column",{attrs:{prop:"pidTitle",label:"上级菜单名称"}}),r("el-table-column",{attrs:{prop:"isMenu",label:"是否是菜单",formatter:e.formatIsMenu}}),r("el-table-column",{attrs:{prop:"levels",label:"层级"}}),r("el-table-column",{attrs:{prop:"sort",label:"排序"}}),r("el-table-column",{attrs:{prop:"index",label:"请求地址"}}),r("el-table-column",{attrs:{prop:"req",label:"请求方式"}}),r("el-table-column",{attrs:{prop:"vueSuperior",label:"菜单前置路径"}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),r("br"),r("el-pagination",{attrs:{"current-page":e.queryinfo.pagenum,"page-sizes":[10,20,50,100],"page-size":e.queryinfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalpage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]],2)],1)],1)])]),r("el-dialog",{attrs:{title:"新增",width:"500px",visible:e.addFormVisible,"before-close":e.addCancel},on:{"update:visible":function(t){e.addFormVisible=t}}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"90px",rules:e.FormRules}},[r("el-form-item",{attrs:{label:"菜单名称",prop:"title"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入菜单名称"},model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),r("el-form-item",{attrs:{label:"菜单路径",prop:"index"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"菜单为单路径（menus），权限可多路径（menus/id)"},model:{value:e.addForm.index,callback:function(t){e.$set(e.addForm,"index",t)},expression:"addForm.index"}})],1),r("el-form-item",{attrs:{label:"是否是菜单",prop:"isMenu"}},[r("el-radio-group",{model:{value:e.addForm.isMenu,callback:function(t){e.$set(e.addForm,"isMenu",t)},expression:"addForm.isMenu"}},[r("el-radio",{attrs:{label:"1"}},[e._v("是")]),r("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),r("el-form-item",{attrs:{label:"上级菜单",prop:"pid"}},[r("el-row",[r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{disabled:"","auto-complete":"off",placeholder:"请选择上级菜单"},model:{value:e.addForm.pidTitle,callback:function(t){e.$set(e.addForm,"pidTitle",t)},expression:"addForm.pidTitle"}})],1),r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{disabled:"","auto-complete":"off",placeholder:"请选择上级菜单"},model:{value:e.addForm.pid,callback:function(t){e.$set(e.addForm,"pid",t)},expression:"addForm.pid"}})],1),r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.addPidSelect}},[e._v("选择")])],1)],1)],1),1==e.addForm.isMenu?r("el-form-item",{attrs:{label:"序号",prop:"sort"}},[r("el-input",{attrs:{type:"number","auto-complete":"off",placeholder:"请输入序号"},model:{value:e.addForm.sort,callback:function(t){e.$set(e.addForm,"sort",t)},expression:"addForm.sort"}})],1):e._e(),1==e.addForm.isMenu?r("el-form-item",{attrs:{label:"前置路径",prop:"vueSuperior"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入components目录下到存放.vue的目录"},model:{value:e.addForm.vueSuperior,callback:function(t){e.$set(e.addForm,"vueSuperior",t)},expression:"addForm.vueSuperior"}})],1):e._e(),1==e.addForm.isMenu?r("el-form-item",{attrs:{label:"图标",prop:"icon",disabled:""}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入图标"},model:{value:e.addForm.icon,callback:function(t){e.$set(e.addForm,"icon",t)},expression:"addForm.icon"}})],1):e._e(),0==e.addForm.isMenu?r("el-form-item",{attrs:{label:"请求方式",prop:"req"}},[r("el-radio-group",{model:{value:e.addForm.req,callback:function(t){e.$set(e.addForm,"req",t)},expression:"addForm.req"}},[r("el-radio",{attrs:{label:"get"}}),r("el-radio",{attrs:{label:"post"}}),r("el-radio",{attrs:{label:"put"}}),r("el-radio",{attrs:{label:"delete"}})],1)],1):e._e(),r("br")],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.addCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("提交")])],1),r("el-dialog",{attrs:{width:"30%",title:"内层 Dialog",visible:e.addInnerVisible,"append-to-body":""},on:{"update:visible":function(t){e.addInnerVisible=t}}},[r("el-tree",{attrs:{data:e.treeMenusListAllSelect,"node-key":"id","expand-on-click-node":!1,"default-expand-all":"",props:e.defaultProps,"highlight-current":""},on:{"node-click":e.addInnerNodeClick}})],1)],1),r("el-dialog",{attrs:{title:"修改",width:"500px",visible:e.editFormVisible,"before-close":e.editCancel},on:{"update:visible":function(t){e.editFormVisible=t}}},[r("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"90px",rules:e.FormRules}},[r("el-form-item",{attrs:{label:"菜单名称",prop:"title"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入菜单名称"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),r("el-form-item",{attrs:{label:"菜单路径",prop:"index"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"菜单为单路径（menus），权限可多路径（menus/id)"},model:{value:e.editForm.index,callback:function(t){e.$set(e.editForm,"index",t)},expression:"editForm.index"}})],1),r("el-form-item",{attrs:{label:"是否是菜单",prop:"isMenu"}},[r("el-radio-group",{model:{value:e.editForm.isMenu,callback:function(t){e.$set(e.editForm,"isMenu",t)},expression:"editForm.isMenu"}},[r("el-radio",{attrs:{label:"1"}},[e._v("是")]),r("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),r("el-form-item",{attrs:{label:"上级菜单",prop:"pid"}},[r("el-row",[r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{disabled:"","auto-complete":"off",placeholder:"请选择上级菜单"},model:{value:e.editForm.pidTitle,callback:function(t){e.$set(e.editForm,"pidTitle",t)},expression:"editForm.pidTitle"}})],1),r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{disabled:"","auto-complete":"off",placeholder:"请选择上级菜单"},model:{value:e.editForm.pid,callback:function(t){e.$set(e.editForm,"pid",t)},expression:"editForm.pid"}})],1),r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.editPidSelect}},[e._v("选择")])],1)],1)],1),1==e.editForm.isMenu?r("el-form-item",{attrs:{label:"序号",prop:"sort"}},[r("el-input",{attrs:{type:"number","auto-complete":"off",placeholder:"请输入序号"},model:{value:e.editForm.sort,callback:function(t){e.$set(e.editForm,"sort",t)},expression:"editForm.sort"}})],1):e._e(),1==e.editForm.isMenu?r("el-form-item",{attrs:{label:"前置路径",prop:"vueSuperior"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入components目录下到存放.vue的目录"},model:{value:e.editForm.vueSuperior,callback:function(t){e.$set(e.editForm,"vueSuperior",t)},expression:"editForm.vueSuperior"}})],1):e._e(),1==e.editForm.isMenu?r("el-form-item",{attrs:{label:"图标",prop:"icon",disabled:""}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入图标"},model:{value:e.editForm.icon,callback:function(t){e.$set(e.editForm,"icon",t)},expression:"editForm.icon"}})],1):e._e(),0==e.editForm.isMenu?r("el-form-item",{attrs:{label:"请求方式",prop:"req"}},[r("el-radio-group",{model:{value:e.editForm.req,callback:function(t){e.$set(e.editForm,"req",t)},expression:"editForm.req"}},[r("el-radio",{attrs:{label:"get"}}),r("el-radio",{attrs:{label:"post"}}),r("el-radio",{attrs:{label:"put"}}),r("el-radio",{attrs:{label:"delete"}})],1)],1):e._e(),r("br")],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.editCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editSubmit}},[e._v("提交")])],1),r("el-dialog",{attrs:{width:"30%",title:"内层 Dialog",visible:e.editInnerVisible,"append-to-body":""},on:{"update:visible":function(t){e.editInnerVisible=t}}},[r("el-tree",{attrs:{data:e.treeMenusListAllSelect,"node-key":"id","expand-on-click-node":!1,"default-expand-all":"",props:e.defaultProps,"highlight-current":""},on:{"node-click":e.editInnerNodeClick}})],1)],1)],1)},l=[],a=(r("4d63"),r("ac1f"),r("25f0"),r("96cf"),r("1da1")),o="顶级菜单",n={data:function(){var e=function(e,t,r){"1"==e.isMenu&&""==e.sort&&r(new Error("请输入序号")),r()},t=function(e,t,r){if("1"==e.isMenu){var i=/^((?!\/).)*$/,l=new RegExp(i);l.test(e.index)||r(new Error("菜单为单路径（menus)"))}r()},r=function(e,t,r){"1"==e.isMenu&&"1"==e.levels&&""==e.vueSuperior&&r(new Error("请输入前置路径")),r()},i=function(e,t,r){"0"==e.isMenu&&""==e.req&&r(new Error("请选择请求方式")),r()},l=function(e,t,r){"0"==e.isMenu?2!==e.levels&&r(new Error("是权限请选择第二层菜单")):"1"==e.isMenu&&(0===e.levels&&1===e.levels||r(new Error("是菜单请选择顶层和一级菜单"))),r()};return{treeMenusListAll:[],defaultProps:{children:"subs",label:"title"},queryinfo:{id:"",title:"",levels:"",pagenum:1,pagesize:10},totalpage:0,tableData:[],selectList:[],addFormVisible:!1,addForm:{index:"",title:"",isMenu:"1",sort:"",req:"get",levels:"",vueSuperior:"",icon:"",pid:"",pidTitle:""},addInnerVisible:!1,FormRules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:1,max:10,message:"菜单名称在1-10个字符之间",trigger:"blur"}],index:[{required:!0,message:"请输入路径",trigger:"blur"},{min:1,max:50,message:"路径在1-50个字符之间",trigger:"blur"},{validator:t,trigger:"blur"}],vueSuperior:[{validator:r,trigger:"blur"},{min:1,max:50,message:"前置路径在1-50个字符之间",trigger:"blur"}],pid:[{validator:l,trigger:"blur"},{required:!0,message:"请选择上级菜单",trigger:"blur"}],sort:[{validator:e,trigger:"blur"}],req:[{validator:i,trigger:"blur"}]},editFormVisible:!1,editForm:{id:"",index:"",title:"",isMenu:"1",sort:"",req:"get",levels:"",vueSuperior:"",icon:"",pid:"",pidTitle:""},editInnerVisible:!1}},computed:{treeMenusListAllSelect:function(){return[{id:"0",subs:this.treeMenusListAll,title:o,levels:"0"}]}},mounted:function(){this.getTreeMenusListAll(),this.getMenuList(),console.log(this.treeMenusListAll)},methods:{getTreeMenusListAll:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("menus/treeListAll");case 2:r=t.sent,console.log(r),200!==r.meta.status&&e.$message.error(r.meta.msg),e.treeMenusListAll=r.data,console.log(e.treeMenusListAll);case 7:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.queryinfo.id=e.id,this.getMenuList()},getMenuList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.getters.getRole("menus","get")){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.get("menus",{params:e.queryinfo});case 4:if(r=t.sent,200===r.meta.status){t.next=8;break}return e.$message.error(r.meta.msg),t.abrupt("return");case 8:console.log("呵呵",r),e.tableData=r.data.datas,e.totalpage=r.data.totalpage,e.queryinfo.pagenum=r.data.pagenum;case 12:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryinfo.pagesize=e,this.queryinfo.pagenum=1,this.getMenuList()},handleCurrentChange:function(e){this.queryinfo.pagenum=e,this.getMenuList()},formatIsMenu:function(e,t){return 1==e.isMenu?"是":0==e.isMenu?"否":"未知"},handleAdd:function(){this.$store.getters.getRole("menus","post")||(this.addFormVisible=!0,this.addForm.icon="el-icon-link")},addCancel:function(){this.addForm={isMenu:"1",req:"get"},this.addFormVisible=!1,this.$refs.addForm.resetFields()},addPidSelect:function(){this.addInnerVisible=!0},addInnerNodeClick:function(e){if(console.log(e),"1"==this.addForm.isMenu){if("1"!=e.levels&&"0"!=e.levels)return void this.$message.error("菜单只能设置为两层")}else if("2"!=e.levels)return void this.$message.error("权限只能设置在第二层菜单内");this.addForm.pid=e.id,this.addForm.pidTitle=e.title,this.addForm.levels=parseInt(e.levels)+1,this.addInnerVisible=!1},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return"1"===e.addForm.isMenu?e.addForm.req="":(e.addForm.vueSuperior="",e.addForm.icon="",e.addForm.sort=""),t.next=5,e.$http.post("menus",e.addForm);case 5:if(i=t.sent,201===i.meta.status){t.next=9;break}return e.$message.error(i.meta.msg),t.abrupt("return");case 9:e.$refs.addForm.resetFields(),e.$message.success(i.meta.msg),e.addFormVisible=!1,e.getTreeMenusListAll(),e.getMenuList(),e.addForm.req="get",e.addForm.pidTitle="";case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleDelete:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.$store.getters.getRole("menus","delete")){e.next=2;break}return e.abrupt("return");case 2:r.$confirm("确认删除吗？","提示",{}).then(Object(a["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$http.delete("menus/".concat(t.id));case 2:if(i=e.sent,204===i.meta.status){e.next=6;break}return r.$message.error(i.meta.msg),e.abrupt("return");case 6:r.$message.success(i.meta.msg),r.getMenuList(),r.getTreeMenusListAll();case 9:case"end":return e.stop()}}),e)})))).catch((function(){}));case 3:case"end":return e.stop()}}),e)})))()},handleEdit:function(e,t){this.$store.getters.getRole("menus","put")||(this.editFormVisible=!0,"0"==t.pid&&(t.pidTitle=o),this.editForm=JSON.parse(JSON.stringify(t)))},editCancel:function(){this.editForm={isMenu:"1",req:"get"},this.editFormVisible=!1,this.$refs.editForm.resetFields()},editPidSelect:function(){this.editInnerVisible=!0},editInnerNodeClick:function(e){if(console.log(e),"1"==this.editForm.isMenu){if("1"!=e.levels&&"0"!=e.levels)return void this.$message.error("菜单只能设置为两层")}else if("2"!=e.levels)return void this.$message.error("权限只能设置在第二层菜单内");this.editForm.pid=e.id,this.editForm.pidTitle=e.title,this.editForm.levels=parseInt(e.levels)+1,this.editInnerVisible=!1},editSubmit:function(){var e=this;this.$refs.editForm.validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return"1"===e.editForm.isMenu?e.editForm.req="":(e.editForm.vueSuperior="",e.editForm.icon="",e.editForm.sort=""),t.next=5,e.$http.put("menus",e.editForm);case 5:if(i=t.sent,200===i.meta.status){t.next=9;break}return e.$message.error(i.meta.msg),t.abrupt("return");case 9:e.$refs.editForm.resetFields(),e.$message.success(i.meta.msg),e.editFormVisible=!1,e.getTreeMenusListAll(),e.getMenuList(),e.editForm.req="get";case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},changeMenu:function(){"0"==this.editForm.isMenu&&(this.editForm.req="get")}}},s=n,d=r("2877"),u=Object(d["a"])(s,i,l,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0ba30c.485932e1.js.map